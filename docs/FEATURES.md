# 🚀 상세 기능 설명

> 별 헤는 밤의 모든 기능에 대한 상세한 설명입니다.

## 📋 목차
- [💬 실시간 커뮤니케이션](#-실시간-커뮤니케이션)
- [🔐 강화된 보안](#-강화된-보안)
- [🌟 실시간 천체 정보 시스템](#-실시간-천체-정보-시스템)
- [🤖 AI 기반 콘텐츠](#-ai-기반-콘텐츠)
- [📝 커뮤니티 기능](#-커뮤니티-기능)
- [🛍️ 게임화 요소](#️-게임화-요소)
- [🔧 관리자 기능](#-관리자-기능)

---

## 💬 실시간 커뮤니케이션

### 채팅 시스템
- **Native WebSocket(STOMP)**: Socket.IO 의존성 제거, 순수 WebSocket 구현
- **HttpOnly 쿠키 인증**: XSS 공격 방지를 위한 보안 강화
- **하트비트 + 재연결**: 모바일 네트워크 전환 시에도 99% 안정성 보장
- **실시간 공개 채팅**: 전체 사용자 대상 실시간 메시지 교환
- **연결 상태 관리**: 사용자 온라인/오프라인 상태 실시간 표시

### 쪽지 시스템
- **1:1 개인 메시지**: 사용자 간 개인적인 메시지 교환
- **Soft Delete**: 삭제된 메시지도 복구 가능한 논리적 삭제
- **자동 정리**: 오래된 메시지 자동 정리 시스템
- **읽음 상태 관리**: 메시지 읽음/안읽음 상태 추적
- **메시지 검색**: 제목 및 내용 기반 메시지 검색

### 알림 시스템
- **실시간 알림**: WebSocket 기반 즉시 알림 전송
- **브라우저 네이티브 알림**: Notification API 활용 시스템 알림
- **인앱 브라우저 호환성**: 카카오톡, 네이버 등 인앱 브라우저에서도 100% 동작
- **알림 타입**: 댓글, 좋아요, 쪽지, 시스템 알림 등 다양한 알림 지원
- **알림 설정**: 사용자별 알림 on/off 설정 가능

---

## 🔐 강화된 보안

### SSRF 취약점 해결
- **CloudFront Signed URL**: 서버 사이드 요청 위조 공격 100% 차단
- **내부 네트워크 보호**: 사용자 제공 URL로 내부 시스템 접근 차단
- **URL 검증**: 허용된 도메인만 접근 가능하도록 화이트리스트 관리

### 파일 업로드 보안
- **S3 Presigned URL**: 서버를 거치지 않는 직접 업로드로 부하 33% 감소
- **CloudFront OAC**: Origin Access Control로 S3 직접 접근 차단
- **하이브리드 시스템**: 업로드는 S3, 조회는 CloudFront로 보안성 향상
- **파일 타입 검증**: 허용된 파일 형식만 업로드 가능
- **파일 크기 제한**: 업로드 파일 크기 제한으로 서버 보호

### 이메일 인증
- **HTML 템플릿**: 시각적으로 개선된 이메일 디자인
- **8자리 영숫자 코드**: 기존 6자리 숫자 대비 보안성 300% 향상
- **재시도 로직**: 이메일 전송 실패 시 자동 재시도
- **시도 횟수 제한**: 5회/10분 제한으로 무차별 대입 공격 방지
- **만료 시간**: 인증 코드 유효 시간 설정

### JWT + Redis 인증
- **토큰 자동 갱신**: 게시글 작성 중 토큰 만료 시 자동 갱신으로 데이터 손실 95% 감소
- **블랙리스트 관리**: Redis 기반 토큰 블랙리스트로 탈취된 토큰 무효화
- **탈취 감지**: 비정상적인 토큰 사용 패턴 감지 및 차단
- **HttpOnly 쿠키**: XSS 공격으로부터 토큰 보호
- **Refresh Token**: 7일 유효기간으로 보안과 편의성 균형

### 이미지 검열
- **Google Vision API**: AI 기반 부적절 콘텐츠 자동 감지
- **실시간 검열**: 이미지 업로드 시 즉시 검열 수행
- **다양한 카테고리**: 성인 콘텐츠, 폭력, 의료 등 다양한 부적절 콘텐츠 감지
- **자동 차단**: 부적절 콘텐츠 감지 시 자동 업로드 차단

### 동시성 제어
- **Redis 분산 락**: Redisson 기반 분산 락으로 동시성 문제 해결
- **포인트 중복 지급 방지**: 99% 정확도로 중복 지급 방지
- **공정성 보장**: 락 획득 순서 보장으로 공정한 처리
- **재진입 지원**: 같은 스레드에서 락 재획득 가능

### 소셜 계정 복구 시스템
- **30일 복구 기간**: 탈퇴 후 30일 내 완전 복구 가능
- **이메일 기반 닉네임**: 소셜 연동 해제 시 이메일 기반 고유 닉네임 자동 생성
- **단계별 데이터 정리**: 30일(소프트 삭제) → 1년(하드 삭제) 단계적 처리
- **개인정보보호법 준수**: 법적 요구사항에 맞는 데이터 보존 정책

---

## 🌟 실시간 천체 정보 시스템

### 실시간 관측 조건
- **Geolocation API**: 사용자 위치 자동 감지
- **OpenWeatherMap 연동**: 실시간 날씨 데이터 수집
- **별 관측 적합도**: 구름량, 시정, 습도 등을 종합한 관측 조건 분석
- **4단계 등급**: EXCELLENT/GOOD/FAIR/POOR 등급으로 관측 품질 표시
- **위치 기반 서비스**: GPS 권한 거부 시 서울 기준 기본값 제공

### 천체 이벤트 알림
- **NASA API 연동**: 실제 천체 데이터 자동 수집
- **다양한 이벤트**: 유성우, 태양 플레어, 지구 근접 소행성 등
- **24시간 전 알림**: 천체 이벤트 발생 24시간 전 사용자 알림
- **자동 수집**: 매일 자동으로 새로운 천체 이벤트 수집
- **이벤트 상세 정보**: 시간, 위치, 관측 방법 등 상세 정보 제공

### NASA API 통합
- **NeoWs API**: 지구 근접 소행성 정보
- **DONKI API**: 우주 기상 정보 (태양 플레어, 자기폭풍 등)
- **ISS API**: 국제우주정거장 위치 및 통과 시간
- **실시간 데이터**: 최신 우주 정보 실시간 업데이트
- **글로벌 데이터**: 전 세계 천체 관측 정보 제공

### 스마트 추천
- **구름량 분석**: 별 관측에 영향을 주는 구름량 실시간 분석
- **시정 분석**: 대기 투명도 측정으로 관측 품질 예측
- **달의 위상**: 달빛이 별 관측에 미치는 영향 고려
- **최적 시간 추천**: 하루 중 가장 좋은 관측 시간 추천
- **장소 추천**: 사용자 위치 기반 최적 관측 장소 추천

### 위치 기반 서비스
- **자동 위치 감지**: GPS 기반 자동 위치 설정
- **수동 위치 설정**: 사용자가 직접 관측 위치 설정 가능
- **1시간 캐싱**: API 호출 최적화로 95% 호출 감소
- **오프라인 지원**: 네트워크 연결이 불안정해도 기본 정보 제공
- **프라이버시 보호**: 위치 정보는 세션에만 저장, 서버에 저장하지 않음

---

## 🤖 AI 기반 콘텐츠

### 뉴스 수집
- **NewsData.io API**: 우주/과학 관련 뉴스 자동 수집
- **AI 요약**: Claude/OpenAI API를 활용한 뉴스 요약
- **AI 분류**: 뉴스 카테고리 자동 분류 (우주탐사, 천문학, 과학기술 등)
- **200개 키워드**: 다양한 우주 관련 키워드로 뉴스 수집
- **DB 조회 성능 85% 향상**: 효율적인 키워드 검색 시스템
- **중복 제거**: 동일한 뉴스 자동 감지 및 제거
- **다국어 지원**: 한국어, 영어 뉴스 수집 및 번역

### 별빛시네마
- **YouTube API**: 우주 관련 영상 자동 수집
- **자동 번역**: 영어 영상 제목/설명 한국어 번역
- **영상 다양성 2배 증가**: 다양한 채널에서 영상 수집
- **중복 영상 5% 미만**: 효율적인 중복 감지 알고리즘
- **품질 필터링**: 조회수, 평점 기반 고품질 영상만 선별
- **카테고리 분류**: 다큐멘터리, 교육, 뉴스 등 자동 분류
- **정기 업데이트**: 매일 새로운 영상 자동 수집

### 토론 시스템
- **AI 기반 주제 생성**: Claude/OpenAI API 활용 일일 토론 주제 생성
- **시의성 반영**: 최신 우주 뉴스와 이벤트를 반영한 주제 생성
- **다양한 주제**: 과학적 토론부터 철학적 질문까지 다양한 주제
- **참여 유도**: 사용자 참여를 유도하는 흥미로운 주제 선별
- **토론 관리**: 건전한 토론 문화 조성을 위한 관리 기능

---

## 📝 커뮤니티 기능

### 게시글 시스템
- **CRUD 기능**: 게시글 생성, 조회, 수정, 삭제
- **좋아요 시스템**: 게시글 추천 기능
- **신고 시스템**: 부적절한 게시글 신고 및 처리
- **인기글**: 좋아요 수 기반 인기 게시글 선별
- **카테고리**: 자유게시판, 질문게시판, 정보공유 등 다양한 카테고리
- **검색 기능**: 제목, 내용, 작성자 기반 검색
- **페이지네이션**: 효율적인 게시글 목록 표시

### Toast UI 에디터
- **마크다운 지원**: 마크다운 문법으로 풍부한 텍스트 작성
- **커스텀 툴바**: 색상 변경, 텍스트 정렬 기능 추가
- **이미지 삽입**: 드래그 앤 드롭으로 이미지 삽입
- **실시간 미리보기**: 작성 중 실시간 미리보기 제공
- **자동 저장**: 작성 중인 내용 자동 저장으로 데이터 손실 방지

### 댓글 시스템
- **계층형 댓글**: 대댓글 지원으로 체계적인 토론 가능
- **좋아요 기능**: 댓글별 좋아요 기능
- **신고 기능**: 부적절한 댓글 신고 시스템
- **실시간 업데이트**: 새 댓글 실시간 표시
- **댓글 알림**: 내 게시글에 댓글 작성 시 알림

### 검색 및 필터
- **통합 검색**: 제목, 내용, 작성자 통합 검색
- **카테고리별 필터링**: 카테고리별 게시글 필터링
- **정렬 옵션**: 최신순, 인기순, 댓글순 정렬
- **고급 검색**: 기간, 작성자 등 상세 검색 조건
- **검색 결과 하이라이트**: 검색어 하이라이트 표시

### 신고 시스템
- **다양한 신고 사유**: 스팸, 욕설, 부적절한 콘텐츠 등
- **관리자 처리**: 관리자가 신고 내용 검토 및 처리
- **자동 블라인드**: 일정 신고 수 이상 시 자동 블라인드 처리
- **신고자 보호**: 신고자 정보 비공개
- **처리 결과 알림**: 신고 처리 결과 알림

### 보안 강화된 파일 업로드
- **S3 Presigned URL**: 서버 부하 없는 직접 업로드
- **CloudFront CDN**: 전 세계 엣지 캐싱으로 빠른 이미지 로딩
- **Google Vision API 검열**: AI 기반 부적절한 이미지 자동 차단 및 삭제
- **SSRF 취약점 완전 차단**: CloudFront URL만 허용으로 서버 사이드 요청 위조 공격 방지
- **다층 보안 검증**: 클라이언트/서버/AI 3단계 검증 시스템
- **자동 정리 시스템**: 7일 이상 된 orphan 이미지 자동 삭제
- **Rate Limiting**: IP 기반 업로드 횟수 제한 (10분/10회)

### 이미지 업로드 파이프라인
- **파일 선택**: 일반적인 파일 선택 방식
- **클립보드 붙여넣기**: Ctrl+V로 클립보드 이미지 직접 붙여넣기 (모바일 제한)
- **실시간 검열**: Google Vision API 기반 즉시 검열 및 부적절 이미지 자동 삭제
- **서버 부하 33% 감소**: S3 직접 업로드로 서버 리소스 절약
- **ReactMarkdown 렌더링**: rehype-sanitize 기반 안전한 HTML 렌더링
- **컴포넌트화**: 재사용 가능한 ImageUploader 컴포넌트
- **자동 재시도**: 네트워크 오류 시 지수 백오프 재시도 로직
- **브라우저 호환성**: 인앱 브라우저 등 다양한 환경 지원

---

## 🛍️ 게임화 요소

### 포인트 시스템
- **출석체크**: 매일 출석체크로 포인트 획득
- **활동 보상**: 게시글 작성, 댓글 작성 등 활동별 포인트 지급
- **일일 제한**: 과도한 포인트 획득 방지를 위한 일일 제한
- **누적 포인트**: 총 획득 포인트 및 현재 보유 포인트 관리
- **포인트 히스토리**: 포인트 획득/사용 내역 조회
- **레벨 시스템**: 누적 포인트 기반 사용자 레벨

### 스텔라 상점
- **45개 우주 테마 아이콘**: 다양한 우주 관련 프로필 아이콘
- **5개 등급별 분류**: Common, Rare, Epic, Legendary, Mythic 등급
- **애니메이션 효과**: 아이콘별 고유한 애니메이션 효과
- **포인트 구매**: 게임 내 포인트로 아이콘 구매
- **컬렉션 시스템**: 보유한 아이콘 컬렉션 관리
- **희귀도 시스템**: 등급별 다른 획득 확률

### 인증서 시스템
- **활동 기반 성취**: 다양한 활동을 통한 인증서 획득
- **8가지 인증서 종류**:
  - 별빛탐험가: 첫 게시글 작성
  - 우주인등록: 회원가입 완료
  - 은하통신병: 첫 댓글 작성
  - 스텔라컬렉터: 첫 아이콘 구매
  - 코스믹메신저: 첫 쪽지 발송
  - 천체관측자: 날씨 위젯 첫 사용
  - 우주뉴스리더: 뉴스 첫 조회
  - 별빛시네마팬: 영상 첫 시청
- **진행률 표시**: 인증서 획득 조건 및 진행률 표시
- **프로필 표시**: 획득한 인증서 프로필에 표시

---

## 🔧 관리자 기능

### 사용자 관리
- **계정 상태 변경**: 활성/비활성/정지 상태 관리
- **제재 시스템**: 경고, 일시정지, 영구정지 등 단계별 제재
- **1년 보존**: 제재된 계정 1년간 보존 후 완전 삭제
- **닉네임 변경권**: 사용자에게 닉네임 변경 권한 부여
- **사용자 검색**: 닉네임, 이메일 기반 사용자 검색
- **활동 내역**: 사용자별 활동 내역 조회

### 콘텐츠 관리
- **게시글 관리**: 게시글 블라인드, 삭제, 카테고리 이동
- **댓글 관리**: 댓글 블라인드, 삭제
- **신고 처리**: 신고된 콘텐츠 검토 및 처리
- **일괄 처리**: 여러 콘텐츠 일괄 처리 기능
- **처리 로그**: 관리자 처리 내역 로그 관리

### 채팅 관리
- **채팅방 참여자 관리**: 사용자 강제 퇴장, 입장 금지
- **채팅 금지**: 특정 사용자 채팅 금지
- **채팅 로그**: 채팅 내역 조회 및 관리
- **실시간 모니터링**: 채팅방 실시간 모니터링
- **자동 필터링**: 욕설, 스팸 자동 필터링

### 통계 대시보드
- **사용자 통계**: 가입자 수, 활성 사용자 수, 접속 통계
- **콘텐츠 통계**: 게시글 수, 댓글 수, 조회수 통계
- **시스템 통계**: 서버 성능, API 호출 통계
- **실시간 모니터링**: 실시간 시스템 상태 모니터링
- **리포트 생성**: 주간/월간 통계 리포트 자동 생성

### 소셜 계정 관리
- **연동 해제 감지**: 소셜 플랫폼에서 연동 해제 시 자동 감지
- **즉시 탈퇴 처리**: 연동 해제 감지 시 즉시 탈퇴 처리
- **30일 복구 가능**: 탈퇴 후 30일 내 계정 복구 지원
- **데이터 보존**: 개인정보보호법에 따른 데이터 보존 정책
- **복구 프로세스**: 간단한 복구 프로세스 제공

---

## 🔗 관련 문서

- [🏗️ 아키텍처 가이드](./03_architecture.md)
- [🔧 기술 스택 상세](./06_TECH-STACK.md)
- [🚀 성능 최적화](./05_optimizations.md)
- [📁 이미지 업로드 파이프라인 상세](./14_image-upload-pipeline.md)
- [🧪 테스트 가이드](./07_testing.md)
- [📦 배포 가이드](./08_deployment.md)