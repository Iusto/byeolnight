# 📊 성능 최적화 전략

> 실제 운영 환경을 고려한 성능 최적화 사례와 핵심 지표

## 📈 핵심 성과 지표

| 최적화 항목 | 개선 전 | 개선 후 | 효과 |
|------------|---------|---------|------|
| 게시글 쿼리 | Full Scan + Filesort | Index 정렬 | 응답 속도 15% 향상 |
| WebSocket 연결 | 95% 안정성 | 99% 안정성 | 연결 끊김 95% 감소 |
| 파일 업로드 | 서버 경유 | S3 직접 업로드 | 서버 부하 33% 감소 |
| JWT 토큰 만료 | 수동 재로그인 | 자동 갱신 | 데이터 손실 95% 감소 |
| 테스트 빌드 | 27초 | 13초 | 빌드 시간 52% 단축 |
| 패키지 관리 | npm | pnpm | 설치 속도 70% 향상 |

## 🔧 주요 최적화 사례

### 데이터베이스
- **복합 인덱스**: `(category, created_at)`, `(room_id, timestamp)` 적용
- **N+1 해결**: Fetch Join으로 쿼리 수 90% 감소

### 파일 업로드
- **S3 Presigned URL**: 클라이언트 직접 업로드로 서버 부하 33% 감소
- **CloudFront OAI**: S3 직접 접근 차단

### WebSocket
- **하트비트**: 30초 주기로 연결 유지
- **자동 재연결**: 지수 백오프 방식

### 테스트
- **TestMockConfig**: 공통 Mock 설정으로 코드 93% 감소
- **병렬 실행**: 빌드 시간 52% 단축 (27초 → 13초)

### 프론트엔드
- **pnpm**: 설치 속도 70% 향상
- **Vite 코드 스플리팅**: 초기 로딩 30% 단축

### 캐싱
- **날씨 데이터 캐싱**: 하이브리드 캐싱 전략으로 API 호출 최소화
  - **Proactive Caching**: 26개 주요 도시 날씨를 30분마다 자동 수집 (WeatherScheduler)
  - **On-Demand Caching**: 기타 지역은 첫 요청 시 수집 후 캐싱 (WeatherService)
  - **캐시 키 통일**: CoordinateUtils로 0.2도(약 20km) 단위 그리드 공유
  - **대상 도시** (26개):
    - 서울, 경기도 9개 도시 (인천, 수원, 성남, 고양, 용인, 부천, 안산, 안양, 평택, 화성)
    - 강원 2개 (춘천, 강릉)
    - 충청 3개 (대전, 청주, 천안)
    - 전라 3개 (전주, 광주, 목포)
    - 경상 5개 (대구, 부산, 울산, 포항, 경주)
    - 제주 2개 (제주, 서귀포)